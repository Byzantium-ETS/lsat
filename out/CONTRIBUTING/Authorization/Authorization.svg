<?xml version="1.0" encoding="windows-1252" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="638px" preserveAspectRatio="none" style="width:875px;height:638px;background:#FFFFFF;" version="1.1" viewBox="0 0 875 638" width="875px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="270" x="303.5" y="27.9951">L402 : Service authorization flow</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="173.8594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="535.125"/><rect fill="none" height="478.7969" style="stroke:#000000;stroke-width:1.5;" width="858" x="10" y="135.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="44" x2="44" y1="118.5938" y2="631.3906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="162.5" x2="162.5" y1="118.5938" y2="631.3906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="332" x2="332" y1="118.5938" y2="631.3906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="505.5" x2="505.5" y1="118.5938" y2="631.3906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="650.5" x2="650.5" y1="118.5938" y2="631.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="20" y="115.292">Client</text><ellipse cx="44.5" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M44.5,58.7969 L44.5,85.7969 M31.5,66.7969 L57.5,66.7969 M44.5,85.7969 L31.5,100.7969 M44.5,85.7969 L57.5,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="113.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="120.5" y="107.292">Client Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="251" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="258" y="107.292">Authorization Server</text><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="435.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="442.5" y="107.292">Auth Server Node</text><rect fill="#E06666" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="585.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="592.5" y="107.292">Resource Server</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="173.8594"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="535.125"/><path d="M10,135.5938 L76,135.5938 L76,142.7266 L66,152.7266 L10,152.7266 L10,135.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="478.7969" style="stroke:#000000;stroke-width:1.5;" width="858" x="10" y="135.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="25" y="148.6606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="91" y="147.8042">[First time user]</text><polygon fill="#181818" points="315.5,169.8594,325.5,173.8594,315.5,177.8594,319.5,173.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="321.5" y1="173.8594" y2="173.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="51.5" y="168.7935">GET /</text><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="379.5" y1="202.9922" y2="202.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="379.5" y1="202.9922" y2="215.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="338.5" x2="379.5" y1="215.9922" y2="215.9922"/><polygon fill="#181818" points="348.5,211.9922,338.5,215.9922,348.5,219.9922,344.5,215.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="344.5" y="197.9263">Check token, not found</text><polygon fill="#181818" points="488.5,241.125,498.5,245.125,488.5,249.125,492.5,245.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="494.5" y1="245.125" y2="245.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="344.5" y="240.0591">Create invoice</text><polygon fill="#181818" points="348.5,270.2578,338.5,274.2578,348.5,278.2578,344.5,274.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="342.5" x2="504.5" y1="274.2578" y2="274.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="354.5" y="269.1919">Invoice</text><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="379.5" y1="303.3906" y2="303.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="379.5" y1="303.3906" y2="316.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="338.5" x2="379.5" y1="316.3906" y2="316.3906"/><polygon fill="#181818" points="348.5,312.3906,338.5,316.3906,348.5,320.3906,344.5,316.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="344.5" y="298.3247">Mint token + invoice</text><polygon fill="#181818" points="55.5,341.5234,45.5,345.5234,55.5,349.5234,51.5,345.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="331.5" y1="345.5234" y2="345.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="61.5" y="340.4575">402: Payment Required, token + invoice</text><polygon fill="#181818" points="150.5,370.6563,160.5,374.6563,150.5,378.6563,154.5,374.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="156.5" y1="374.6563" y2="374.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="51.5" y="369.5903">Send payment</text><polygon fill="#181818" points="488.5,399.7891,498.5,403.7891,488.5,407.7891,492.5,403.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162.5" x2="494.5" y1="403.7891" y2="403.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="169.5" y="398.7231">Send payment</text><polygon fill="#181818" points="173.5,428.9219,163.5,432.9219,173.5,436.9219,169.5,432.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="504.5" y1="432.9219" y2="432.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="179.5" y="427.856">Preimage</text><polygon fill="#181818" points="55.5,458.0547,45.5,462.0547,55.5,466.0547,51.5,462.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="161.5" y1="462.0547" y2="462.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="61.5" y="456.9888">Preimage</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="868" y1="471.0547" y2="471.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128" x="15" y="481.2651">[User with a token]</text><polygon fill="#181818" points="320.5,501.9922,330.5,505.9922,320.5,509.9922,324.5,505.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="326.5" y1="505.9922" y2="505.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="51.5" y="500.9263">GET /protected, token + preimage</text><polygon fill="#181818" points="634,531.125,644,535.125,634,539.125,638,535.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="640" y1="535.125" y2="535.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="339.5" y="530.0591">GET /protected, token + preimage</text><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="698" y1="564.2578" y2="564.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="698" x2="698" y1="564.2578" y2="577.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="657" x2="698" y1="577.2578" y2="577.2578"/><polygon fill="#181818" points="667,573.2578,657,577.2578,667,581.2578,663,577.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="663" y="559.1919">Check token, validate caveats</text><polygon fill="#181818" points="55.5,602.3906,45.5,606.3906,55.5,610.3906,51.5,606.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="650" y1="606.3906" y2="606.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="61.5" y="601.3247">Protected</text><!--SRC=[ZLBHJi9G37tVLpJmA4HYZ05YJ71HOwA6W7x0PIlIiEtEksw8Ns_llGmst8FtQMlFQSzfoyG9milrw0gci4HJKOIWIjveGp-AIMUmJlGk23OK8nIC1ZNlS_J_cEQyXnJJ5Ph2XzPQyqf_1u6AM1i84yACGHKG1haoJ17bIWAzG-9DnzXpQVi5_Vl9R3mPjw6pbXmh4etZsCHVw05nAhrqfRjhBx3GfH7FZR8IWpwERkI9ZOJXaKp1m9GYb0MQ0224uPrhFuMdXtUub93ufKenUbKWpuavui8DHbjWlSLi09bccLIPnIsW4of8WxOEPPMMRJZ4iRY3kD21TZiSrhpd1Y763afRq2l909mUk6Wr2rrH3vB3cC9SxLExh0L-bMGm7dJG6WqF0t0p2hsq9MOnvBwCJRcDd1oVfJkaUqR3xDmWfUhph7LDy1R2CsY0IO7m8Ik47SaebFVHiS_SQCQ8crRpKyDwZd8e_y8VvGd1kR4NLlDRTr6fX6ABZ5GbHr0qzk70yxfFsxQj6yWCVm40]--></g><script xmlns="" id="bw-fido2-page-script"/></svg>