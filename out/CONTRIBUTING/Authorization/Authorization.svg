<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="709px" preserveAspectRatio="none" style="width:933px;height:709px;background:#FFFFFF;" version="1.1" viewBox="0 0 933 709" width="933px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="262" x="336.75" y="27.9951">L402 : Service authorization flow</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="173.8594"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="491.1875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="554.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="554.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="696.5" y="606.3906"/><rect fill="none" height="550.0625" style="stroke:#000000;stroke-width:1.5;" width="916.5" x="10" y="135.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="160.5" x2="160.5" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="327" x2="327" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="559" x2="559" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="701" x2="701" y1="118.5938" y2="702.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="20" y="115.292">Client</text><ellipse cx="42.5" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M42.5,58.7969 L42.5,85.7969 M29.5,66.7969 L55.5,66.7969 M42.5,85.7969 L29.5,100.7969 M42.5,85.7969 L55.5,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="113.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="120.5" y="107.292">Client Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="251" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="258" y="107.292">Authorization Server</text><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="492" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="499" y="107.292">Auth Server Node</text><rect fill="#E06666" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="637" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="644" y="107.292">Resource Server</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="173.8594"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="322.5" y="491.1875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="554.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="554.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="696.5" y="606.3906"/><path d="M10,135.5938 L74,135.5938 L74,142.7266 L64,152.7266 L10,152.7266 L10,135.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="550.0625" style="stroke:#000000;stroke-width:1.5;" width="916.5" x="10" y="135.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="148.6606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="103" x="89" y="147.8042">[First time user]</text><polygon fill="#181818" points="310.5,169.8594,320.5,173.8594,310.5,177.8594,314.5,173.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="316.5" y1="173.8594" y2="173.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="49.5" y="168.7935">GET /</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="202.9922" y2="202.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="202.9922" y2="215.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="215.9922" y2="215.9922"/><polygon fill="#181818" points="343.5,211.9922,333.5,215.9922,343.5,219.9922,339.5,215.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="339.5" y="197.9263">Check token, not found</text><polygon fill="#181818" points="542.5,241.125,552.5,245.125,542.5,249.125,546.5,245.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="548.5" y1="245.125" y2="245.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="339.5" y="240.0591">Create invoice</text><polygon fill="#181818" points="343.5,270.2578,333.5,274.2578,343.5,278.2578,339.5,274.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="337.5" x2="558.5" y1="274.2578" y2="274.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="349.5" y="269.1919">Invoice</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="303.3906" y2="303.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="303.3906" y2="316.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="316.3906" y2="316.3906"/><polygon fill="#181818" points="343.5,312.3906,333.5,316.3906,343.5,320.3906,339.5,316.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="339.5" y="298.3247">Mint token + invoice</text><polygon fill="#181818" points="53.5,341.5234,43.5,345.5234,53.5,349.5234,49.5,345.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47.5" x2="326.5" y1="345.5234" y2="345.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="59.5" y="340.4575">402: Payment Required, token + invoice</text><polygon fill="#181818" points="148.5,370.6563,158.5,374.6563,148.5,378.6563,152.5,374.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="154.5" y1="374.6563" y2="374.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="49.5" y="369.5903">Send payment</text><polygon fill="#181818" points="542.5,399.7891,552.5,403.7891,542.5,407.7891,546.5,403.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="548.5" y1="403.7891" y2="403.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="167.5" y="398.7231">Send payment</text><polygon fill="#181818" points="171.5,428.9219,161.5,432.9219,171.5,436.9219,167.5,432.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="165.5" x2="558.5" y1="432.9219" y2="432.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="177.5" y="427.856">Preimage</text><polygon fill="#181818" points="53.5,458.0547,43.5,462.0547,53.5,466.0547,49.5,462.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47.5" x2="159.5" y1="462.0547" y2="462.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="59.5" y="456.9888">Preimage</text><polygon fill="#181818" points="310.5,487.1875,320.5,491.1875,310.5,495.1875,314.5,491.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="316.5" y1="491.1875" y2="491.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="49.5" y="486.1216">GET /, token + preimage</text><line style="stroke:#181818;stroke-width:1.0;" x1="332.5" x2="374.5" y1="520.3203" y2="520.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="374.5" x2="374.5" y1="520.3203" y2="533.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="333.5" x2="374.5" y1="533.3203" y2="533.3203"/><polygon fill="#181818" points="343.5,529.3203,333.5,533.3203,343.5,537.3203,339.5,533.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="339.5" y="515.2544">Check token, validate payment</text><polygon fill="#181818" points="53.5,558.4531,43.5,562.4531,53.5,566.4531,49.5,562.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47.5" x2="326.5" y1="562.4531" y2="562.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="59.5" y="557.3872">Access token</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="926.5" y1="571.4531" y2="571.4531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="15" y="581.6636">[User with a token]</text><polygon fill="#181818" points="684.5,602.3906,694.5,606.3906,684.5,610.3906,688.5,606.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.5" x2="690.5" y1="606.3906" y2="606.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="49.5" y="601.3247">GET /protected, access token</text><line style="stroke:#181818;stroke-width:1.0;" x1="706.5" x2="748.5" y1="635.5234" y2="635.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="748.5" x2="748.5" y1="635.5234" y2="648.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="707.5" x2="748.5" y1="648.5234" y2="648.5234"/><polygon fill="#181818" points="717.5,644.5234,707.5,648.5234,717.5,652.5234,713.5,648.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="713.5" y="630.4575">Check token, validate caveats</text><polygon fill="#181818" points="53.5,673.6563,43.5,677.6563,53.5,681.6563,49.5,677.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47.5" x2="700.5" y1="677.6563" y2="677.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="59.5" y="672.5903">Protected</text><!--SRC=[bLBBJiD03BpdAwnoX0g4488A8PK841AWgeKFs2OkjKYoOTS9bA_7kvisIPiBUqhicV7umSGPmlF5sJbCO86cfWH1LRpMXduLaovWbUdlA5fJYc0P3MhUb1Z-CIzv0pdcIpGsX5PQyrB_H95AM1k8CyA2GLc8er8PfeHA9O5HatZLAOvysdt1qTtrzEhwgW-TzkmuasWynoKEeGsYbLvuwM7jELfT6Ucv8oinECApItdIHiRmGCOoCEK8bKKJ0SGmllNb9_1u_mQd4f9-gLQCmHN8ysPsk7YDoIUm_iJY10hDCgcgI7j0RrIG1fqE5RMMRNZ4Jjn3VAYXtOp7MzvJXv3Y0ALlw8La0DuF7FUAnLuqWEGm9Z1JczmjQuvV5HbCJmPedOBD0FoCuc1jWKKAPP1nAR-HjkEzz83rmEWqEpD8kVhOAxqbX1RY0-Z-tjfEoXRqhqtMAgFKWLlx_GbEamIj3V21EKMOMOHtEIlu9gcYTaZlLMwniLeQpPYmcxxgI-u41UpBkmFUSeVD9ggM6xCTinuyszRe6tMwaQpe3m00]--></g></svg>