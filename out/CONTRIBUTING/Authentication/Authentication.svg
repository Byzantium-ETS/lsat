<?xml version="1.0" encoding="windows-1252" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="709px" preserveAspectRatio="none" style="width:926px;height:709px;background:#FFFFFF;" version="1.1" viewBox="0 0 926 709" width="926px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="280" x="324" y="27.9951">L402 : Service authentication flow</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="173.8594"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="491.1875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="697" y="606.3906"/><rect fill="none" height="550.0625" style="stroke:#000000;stroke-width:1.5;" width="909" x="10" y="135.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="44" x2="44" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="162.5" x2="162.5" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="332" x2="332" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="556.5" x2="556.5" y1="118.5938" y2="702.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="701.5" x2="701.5" y1="118.5938" y2="702.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="20" y="115.292">Client</text><ellipse cx="44.5" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M44.5,58.7969 L44.5,85.7969 M31.5,66.7969 L57.5,66.7969 M44.5,85.7969 L31.5,100.7969 M44.5,85.7969 L57.5,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="113.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="120.5" y="107.292">Client Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="251" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="258" y="107.292">Authorization Server</text><rect fill="#B9A898" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="486.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="493.5" y="107.292">Auth Server Node</text><rect fill="#E06666" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="636.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="643.5" y="107.292">Resource Server</text><rect fill="#FFFFFF" height="171.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="173.8594"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="327.5" y="491.1875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="245.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="551.5" y="403.7891"/><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="697" y="606.3906"/><path d="M10,135.5938 L76,135.5938 L76,142.7266 L66,152.7266 L10,152.7266 L10,135.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="550.0625" style="stroke:#000000;stroke-width:1.5;" width="909" x="10" y="135.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="25" y="148.6606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="91" y="147.8042">[First time user]</text><polygon fill="#181818" points="315.5,169.8594,325.5,173.8594,315.5,177.8594,319.5,173.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="321.5" y1="173.8594" y2="173.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="51.5" y="168.7935">GET /access</text><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="379.5" y1="202.9922" y2="202.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="379.5" y1="202.9922" y2="215.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="338.5" x2="379.5" y1="215.9922" y2="215.9922"/><polygon fill="#181818" points="348.5,211.9922,338.5,215.9922,348.5,219.9922,344.5,215.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="344.5" y="197.9263">Check token, not found</text><polygon fill="#181818" points="539.5,241.125,549.5,245.125,539.5,249.125,543.5,245.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="545.5" y1="245.125" y2="245.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="344.5" y="240.0591">Create invoice</text><polygon fill="#181818" points="348.5,270.2578,338.5,274.2578,348.5,278.2578,344.5,274.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="342.5" x2="555.5" y1="274.2578" y2="274.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="354.5" y="269.1919">Invoice</text><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="379.5" y1="303.3906" y2="303.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="379.5" y1="303.3906" y2="316.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="338.5" x2="379.5" y1="316.3906" y2="316.3906"/><polygon fill="#181818" points="348.5,312.3906,338.5,316.3906,348.5,320.3906,344.5,316.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="344.5" y="298.3247">Mint token + invoice</text><polygon fill="#181818" points="55.5,341.5234,45.5,345.5234,55.5,349.5234,51.5,345.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="331.5" y1="345.5234" y2="345.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="61.5" y="340.4575">402: Payment Required, token + invoice</text><polygon fill="#181818" points="150.5,370.6563,160.5,374.6563,150.5,378.6563,154.5,374.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="156.5" y1="374.6563" y2="374.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="51.5" y="369.5903">Send payment</text><polygon fill="#181818" points="539.5,399.7891,549.5,403.7891,539.5,407.7891,543.5,403.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162.5" x2="545.5" y1="403.7891" y2="403.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="169.5" y="398.7231">Send payment</text><polygon fill="#181818" points="173.5,428.9219,163.5,432.9219,173.5,436.9219,169.5,432.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="555.5" y1="432.9219" y2="432.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="179.5" y="427.856">Preimage</text><polygon fill="#181818" points="55.5,458.0547,45.5,462.0547,55.5,466.0547,51.5,462.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="161.5" y1="462.0547" y2="462.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="61.5" y="456.9888">Preimage</text><polygon fill="#181818" points="315.5,487.1875,325.5,491.1875,315.5,495.1875,319.5,491.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="321.5" y1="491.1875" y2="491.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="51.5" y="486.1216">GET /access, token + preimage</text><line style="stroke:#181818;stroke-width:1.0;" x1="337.5" x2="379.5" y1="520.3203" y2="520.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="379.5" y1="520.3203" y2="533.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="338.5" x2="379.5" y1="533.3203" y2="533.3203"/><polygon fill="#181818" points="348.5,529.3203,338.5,533.3203,348.5,537.3203,344.5,533.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="344.5" y="515.2544">Check token, validate payment</text><polygon fill="#181818" points="55.5,558.4531,45.5,562.4531,55.5,566.4531,51.5,562.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="331.5" y1="562.4531" y2="562.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="61.5" y="557.3872">Access token</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="919" y1="571.4531" y2="571.4531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128" x="15" y="581.6636">[User with a token]</text><polygon fill="#181818" points="685,602.3906,695,606.3906,685,610.3906,689,606.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="44.5" x2="691" y1="606.3906" y2="606.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="51.5" y="601.3247">GET /protected, access token</text><line style="stroke:#181818;stroke-width:1.0;" x1="707" x2="749" y1="635.5234" y2="635.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="749" x2="749" y1="635.5234" y2="648.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="708" x2="749" y1="648.5234" y2="648.5234"/><polygon fill="#181818" points="718,644.5234,708,648.5234,718,652.5234,714,648.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="714" y="630.4575">Check token, validate caveats</text><polygon fill="#181818" points="55.5,673.6563,45.5,677.6563,55.5,681.6563,51.5,677.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49.5" x2="701" y1="677.6563" y2="677.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="61.5" y="672.5903">Protected</text><!--SRC=[bLBRJjj047ttLupWaKH55Qf2L5KALa6L2ef8-O2DFP0HjjVT7Hl2rtTsrebjufVkaprppfap5oOk47vVNNw59MpGjPGXc8PtM35bXibMy5pOjoJPKOxW6HrQtjSO_x6iUGybbbjqFeQUhUMjVKyIax5ra1OaKc0yf4bjd8XIRIHmrYKUR8vdcWvVS7vplLfSByRGbVYnZZwYdU0IdN92uXJQ8NhfZKfFQp-YjusJfWUo4eDplFmcJzee66x9UGQc4g7nw1A05EO_jFmIxdx-WIycoz1xIKZNr1h6w0tagQKZEjrXzWfiNx6QGMLPvjLK-GYeTWNfCEXGrLfPYYAEuWhHK4VxFfyVUBy6X1mdA6D3zoHZK3zmCIgMgcW4oNqiOMtsPLZP8_vjo64-cw0D2dO3q4cbqTe6gnpgA1DIkfU-uq_f2UkHCMXsxP1Ay_Afz84GMqXFeDFRw_kfU-X_xRCr1UK1t3SndkDA2qNunBGIB3p2avmOl95KCKUaEfQxx0pNpZ9c77PWnf97GG5h-N3C1-wqsSoqScb-O5R1wqEDiT6WcyYY_W40]--></g><script xmlns=""/></svg>